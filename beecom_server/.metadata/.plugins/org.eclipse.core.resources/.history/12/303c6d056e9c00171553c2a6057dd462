package bc_server;

/**
 * @author Ansersion
 *
 */


import org.apache.mina.core.buffer.IoBuffer;
import org.apache.mina.core.session.IoSession;
import org.apache.mina.filter.codec.CumulativeProtocolDecoder;
import org.apache.mina.filter.codec.ProtocolDecoderOutput;

public class BcDecoder extends CumulativeProtocolDecoder {

	final String NEW_CONNECTION = new String("NEW CONNECTION");	
	final String FIXED_HEADER = new String("FIXED HEADER");	
	final String VARIABLE_HEADER = new String("VARIABLE HEADER");	
	final String PAYLOAD = new String("PAYLOAD");	
	final String CRC_CHECKSUM = new String("CRC CHECKSUM");	
	@Override
	protected boolean doDecode(IoSession session, IoBuffer io_in,
			ProtocolDecoderOutput decoder_out) throws Exception {
		// TODO Auto-generated method stub
		if(!session.containsAttribute(NEW_CONNECTION)) {
			session.setAttribute(NEW_CONNECTION, true);
			session.setAttribute(FIXED_HEADER, new FixedHeader());
			session.setAttribute(VARIABLE_HEADER, new VariableHeader());
			session.setAttribute(PAYLOAD, new Payload());
		}
		
		return false;
	}

}
